<?php
ini_set("display_errors", "On"); 
error_reporting(E_ALL & ~E_NOTICE);
include_once '../openadodb.php' ;



$cas_status =$_POST['cas_status'];//案件狀態
$brand =$_POST['brand'];//仲介類別
$date_type = $_POST['date_type'];//時間類別
$report_type = $_POST['report_type'];//報表類別
$branch = $_POST['branch'];//仲介類別
$scrivener = $_POST['scrivener'];//地政士
// echo $_POST['sales'];
// if ($_SESSION['member_id'] == 6) {
// 	print_r($_POST['charge_sales']);
	
// 	die;
// }
// print_r($_POST['charge_sales']);


$from_date = ($start_y + 1911).'-'.str_pad($start_m,2,'0',STR_PAD_LEFT).'-01 00:00:00' ;
$to_date = ($end_y + 1911).'-'.str_pad($end_m,2,'0',STR_PAD_LEFT).'-31 23:59:59' ;

$from_date2 = ($start_y + 1911).'-'.str_pad($start_m,2,'0',STR_PAD_LEFT).'-01' ;
$to_date2 = ($end_y + 1911).'-'.str_pad($end_m,2,'0',STR_PAD_LEFT).'-31' ;

$from_date = '2020-04-01 00:00:00';
$to_date = '2020-06-30 23:59:59';

$from_date2 = '2020-04-01';
$to_date2 = '2020-06-30';
##
//取得合約銀行
$Savings = array() ;
$savingAccount = '' ;
$sql = 'SELECT cBankAccount FROM tContractBank WHERE cShow = 1 GROUP BY cBankAccount ORDER BY cId ASC;' ;

$rs = $conn->Execute($sql);
while (!$rs->EOF) {
	$Savings[] = $rs->fields['cBankAccount'] ;

	$rs->MoveNext();
}
$savingAccount = implode('","',$Savings) ;
unset($Savings) ;

// 取得所有出款保證費紀錄
$sql = '
	SELECT 
		DISTINCT tMemo, 
		tMoney ,
		tBankLoansDate
	FROM 
		tBankTrans 
	WHERE 
		tAccount IN ("'.$savingAccount.'") 
		AND tPayOk="1" 
		AND tKind = "保證費"
		AND tBankLoansDate>="'.$from_date2.'" AND tBankLoansDate<="'.$to_date2.'"
		AND tMemo != "000000000"
	' ;

$rs = $conn->Execute($sql);

while (!$rs->EOF) {
	$check = 1;
	

	if ($check == 1) {

		// $export_date[$rs->fields['tMemo']] = $rs->fields['tBankLoansDate'] ;
		$cCertifiedId[$rs->fields['tMemo']]['cCertifiedId'] = $rs->fields['tMemo'];
		$cCertifiedId[$rs->fields['tMemo']]['tBankLoansDate'] = $rs->fields['tBankLoansDate'];
    $AA[] = $rs->fields['tMemo'];
	}
	
	$rs->MoveNext();
}

unset($check);
##
if ($from_date2 == '2018-01-01' && ($sales == 34 || in_array($sales, $sales_arr))) { //20180103忘記調整到這筆導致下個月才能計算
	$cCertifiedId['005078636']['tBankLoansDate'] = '2018-01-00' ;
	$cCertifiedId['005078636']['cCertifiedId']= '005078636';
}

if ($from_date2 == '2018-01-01') {
	# code...
	$cCertifiedId['004070501']['tBankLoansDate'] = '2018-01-00' ;
	$cCertifiedId['004070501']['cCertifiedId']= '005078636';

}

if ($from_date2 <= '2018-12-01' && $to_date2 <= '2018-12-31') {
	$cCertifiedId['007106507']['tBankLoansDate'] = '2018-12-01' ;
	$cCertifiedId['007106507']['cCertifiedId']= '005078636';
}
##
$_sql = 'SELECT cc.cCertifiedId,cc.cBankList,(SELECT cCertifiedMoney FROM tContractIncome AS ci WHERE ci.cCertifiedId=cc.cCertifiedId) AS cCertifiedMoney FROM tContractCase AS cc WHERE cc.cBankList >= "'.$from_date2.'" AND cc.cBankList<= "'.$to_date2.'"';
$rs = $conn->Execute($_sql);
while (!$rs->EOF) {
	if ($rs->fields['cCertifiedId'] != '007106507') {

		$cCertifiedId[$rs->fields['cCertifiedId']]['tBankLoansDate'] = $rs->fields['cBankList'] ;
		$cCertifiedId[$rs->fields['cCertifiedId']]['cCertifiedId']= $rs->fields['cCertifiedId'];
	}
	
	$rs->MoveNext();
}
##
//案件狀態
$query ='';

if($cas_status != '0'){
	if ($query) { $query .= ' AND ';}
	$query .=" cas.cCaseStatus = '".$cas_status."'";

}
//仲介類別
if($brand != ''){
	// if ($query) { $query .= ' AND ';}

	if($brand==11){//加盟(其他品牌)
		$query .=" AND b.bCategory = '1' AND b.bBrand NOT IN ('1','2','49')";
	}elseif ($brand==12) {//加盟(台灣房屋)
		$query .=" AND b.bCategory = '1' AND b.bBrand ='1'";
	}elseif ($brand==13) {//加盟(優美地產)
		$query .=" AND b.bCategory = '1' AND b.bBrand ='49'";
	}elseif ($brand==1) {//加盟
		$query .=" AND b.bCategory = '1'";
	}elseif ($brand==2) {//直營
		$query .=" AND b.bCategory = '2'";
	}elseif ($brand==3) {//非仲介成交
		$query .=" AND b.bCategory = '3'";
	}
	
}
//時間類別
if($date_type == 1){
	if ($query) { $query .= ' AND ';}
	$query .= " cas.cSignDate>='".$from_date."' AND cas.cSignDate<='".$to_date."'";

	

	$sql = "SELECT cCertifiedId FROM tContractCase AS cas WHERE ".$query;
	$rs = $conn->Execute($sql);
	unset($cCertifiedId);
	$i = 0;
	while (!$rs->EOF) {
		$cCertifiedId[$i]['cCertifiedId'] = $rs->fields['cCertifiedId'];
		$i++;
		$rs->MoveNext();
	}
	unset($i);
}elseif ($date_type == 2) {

	if ($query) { $query .= ' AND ';}
	$query .= ' 1=1';
	
}

##
$data2 = array();


//ORDER BY b.bCategory,b.bBrand,csales.cCertifiedId,csales.cSalesId ASC

// echo implode(",", $AA);



foreach ($AA as $a => $b) {
  $sql= "SELECT * FROM tContractSales WHERE cCertifiedId = '".$b."'";

  $rs = $conn->Execute($sql);
  // echo $rs->fields['cCertifiedId'];
  if ($rs->RecordCount() == 0) {
     $BB[] = '"'.$b.'"';

     
  }

}


$sql = "SELECT
			cc.cCertifiedId,
			cr.cBranchNum,
			cr.cBranchNum1,
			cr.cBranchNum2,
			cc.cFeedbackTarget,
			cc.cFeedbackTarget1,
			cc.cFeedbackTarget2,
			cs.cScrivener,
			(SELECT sCpZip1 FROM tScrivener WHERE sId=cs.cScrivener) AS sCpZip1
		FROM
			tContractCase AS cc
		LEFT JOIN
				tContractRealestate AS cr ON cr.cCertifyId = cc.cCertifiedId
		LEFT JOIN
		    tContractScrivener AS cs ON cs.cCertifiedId= cc.cCertifiedId
		WHERE
			cc.cCertifiedId IN (".implode(",", $BB).")";

$rs = $conn->Execute($sql);
while (!$rs->EOF) {
	$data[] = $rs->fields;

	$rs->MoveNext();
}
$fw = fopen('/var/www/html/first.twhg.com.tw/test2/log/setSales2.log', 'a+');
foreach ($data as $k => $v) {

	if ($v['cBranchNum'] > 0 ) {
		if ($v['cFeedbackTarget'] == 1) { //回饋金對象(1:仲介、2:代書)
			$sales = getSales('b',$v['cBranchNum'] );

		}else{
			$sales = getSales('s',$v['cScrivener'] );

		}

			$sql = " INSERT 
						tContractSales
					SET
						cSalesId = '".$sales."',
						cCertifiedId = '".$v['cCertifiedId']."',
						cTarget = '".$v['cFeedbackTarget']."',
						cBranch = '".$v['cBranchNum']."'";
			$conn->Execute($sql);
			// echo $sql."\r\n";
			// fwrite($fw, $sql.";\r\n");
			// die;

	}

	if ($v['cBranchNum1'] > 0 ) {
		if ($v['cFeedbackTarget1'] == 1) { //回饋金對象(1:仲介、2:代書)
			$sales = getSales('b',$v['cBranchNum1'] );
			


		}else{
			$sales = getSales('s',$v['cScrivener'] );

			
		}

		
		
			$sql = " INSERT INTO
						tContractSales
					WHERE
						cCertifiedId = '".$v['cCertifiedId']."',
						cTarget = '".$v['cFeedbackTarget1']."',
						cSalesId = '".$sales."',
						cBranch = '".$v['cBranchNum1']."'";
						$conn->Execute($sql);
			// echo $sql."\r\n";
						$conn->Execute($sql);
			// fwrite($fw, $sql.";\r\n");
			// die;
	
	}


	if ($v['cBranchNum2'] > 0 ) {
		if ($v['cFeedbackTarget2'] == 1) { //回饋金對象(1:仲介、2:代書)
			$sales = getSales('b',$v['cBranchNum2'] );

		}else{
			$sales = getSales('s',$v['cScrivener'] );

		}

		$sql = " INSERT 
					tContractSales
				SET
					cSalesId = '".$sales."',
					cCertifiedId = '".$v['cCertifiedId']."',
					cTarget = '".$v['cFeedbackTarget2']."',
					cBranch = '".$v['cBranchNum2']."'";
					// echo $sql."\r\n";
					$conn->Execute($sql);
			// fwrite($fw, $sql.";\r\n");
			// die;

	}
}
fclose($fw);
function getSales($cat,$id){
	global $conn;

	if ($cat == 'b') {
		$sql = "SELECT bSales AS sales FROM tBranchSales WHERE bBranch = '".$id."'";
	}elseif ($cat == 's') {
		$sql = "SELECT sSales AS sales FROM tScrivenerSales WHERE sScrivener = '".$id."'";
	}

	$rs = $conn->Execute($sql);

	return $rs->fields['sales'];
}
die;

$bb42 = array(
848,471,472,676,705,709,780,972,1246,1924,1993,2054,2102,2351,2490,2509,2525,2770,2784,2955,3229,3292,1073,1366,2029,2607,2615,2675,2892,2155,473,550,2390,710,2487,912,913,918,1273,1460,1672,1627,1667,1695,1736,1787,1865,1925,2279,2377,2496,2546,3032,3205,3265,474,475,538,565,677,730,774,797,838,879,992,1107,1485,1167,1232,1256,1362,1437,1514,1734,1874,1878,1897,1969,1996,1998,2051,2053,2166,2346,2448,2681,2733,2777,2839,2852,2947,2949,3114,3128,476,477,608,661,662,663,697,1025,1030,1105,1428,1673,1703,1928,2050,2117,2146,2164,2168,2192,2523,2602,2647,2768,3046,3338,3397,1445,478,479,480,481,482,535,1396,707,714,837,843,885,890,920,1017,1168,1169,1192,2352,1251,1272,1281,1289,1317,1329,1350,1758,1887,2036,2063,2122,2136,2150,2167,2188,2274,2419,2435,2617,2808,2983,2995,3202,1583,512,578,702,1492,1039,3271,1352,1607,1870,1881,2093,2239,2360,2452,2898,2932,3014,3380,1250,1252,2541,3248,1589,483,484,485,554,590,609,621,713,729,2480,868,886,907,954,958,1539,1402,1043,1055,1132,1137,1170,1274,1275,1291,1374,1435,1541,1542,1565,1573,1599,1608,1609,1616,1617,1709,1725,1755,1793,1789,1886,1893,1895,2037,2038,2156,2160,2196,2230,2240,2306,2320,2385,2478,2563,2588,2754,2819,2945,2946,3276,3309,486,516,1590,1079,1615,1642,1643,1699,1762,2169,2530,2996,3005,539,1840,1871,487,488,610,721,723,1338,1382,1557,1575,1578,1735,1786,1830,1860,1861,1933,2127,2264,2273,2833,3157,489,725,1576,3307,1524,1577,3098,1637,1161,696,747,782,833,844,955,994,1002,1007,1063,1151,1152,1183,1253,1311,1336,1379,1446,1454,1487,1648,1702,1868,2019,2045,2052,2144,2145,2280,2412,2432,2437,2493,2506,2794,2864,3071,3094,3250,3404,490,820,1660,706,2078,1333,1791,2470,2604,1286,1923,491,715,1361,1778,2187,2416,2473,2565,2629,3060,3369,493,494,495,496,2333,1817,594,1639,720,1726,1482,1398,1315,1582,1341,1540,1613,1813,1986,2005,2304,2392,2431,2462,2479,2527,2555,2697,2809,2978,3009,3249,3266,3304,3324,3325,3345,3370,3393,2587,1466,1785,1947,2902,3122,857,2234,1553,1554,1555,1905,2943,3024,3381,2477,497,2007,2458,2673,2787,3318,498,1651,499,2057,2407,1003,1693,1754,1809,1719,1243,1592,1746,2033,2075,2115,2198,2151,2391,2461,2463,2540,2543,2547,2611,2618,2720,2734,2771,2840,2849,2850,2869,2877,2915,2952,2985,3000,3187,3274,3337,3283,2740,2820,1910
);

		$bb47 =  array(
  174,502,509,510,518,935,1297,2656,175,176,1406,2158,1459,1534,1775,2221,2628,2924,3091,108,185,186,187,188,189,191,2471,503,561,655,718,724,740,1403,836,853,951,1946,1024,1045,1062,1320,1407,1502,1517,1685,1837,1839,1841,1952,2101,2132,2201,2302,2552,2622,3059,3124,3290,3298,3407,3408,190,2231,549,1136,2640,3241,192,193,194,195,1497,1400,812,944,1378,1500,1602,1628,1629,1708,1919,2855,2865,3168,3227,207,208,209,210,542,544,806,1469,932,933,934,936,960,1820,2498,1499,215,216,217,218,219,220,221,222,223,258,551,726,769,804,813,831,840,878,880,1413,1026,1029,1126,1225,1229,1390,1556,1843,1911,1940,2401,2591,2686,2766,2936,2969,2982,3045,3116,3129,3164,3355,230,548,791,1836,231,232,233,234,235,236,237,238,239,515,727,792,793,846,1175,1334,1438,1958,2225,2261,2454,2632,2782,2824,2923,3003,3050,3069,3176,240,241,242,243,244,245,734,751,762,775,940,2338,1028,1425,1162,1203,1456,2068,2114,2635,2793,3190,3218,763,246,247,248,249,570,598,776,799,874,908,914,1120,1533,1535,1848,2030,2092,2227,2266,2313,2366,2520,2752,3074,250,251,252,253,704,871,1060,1675,1912,2031,2069,2130,2251,2393,2721,2875,3080,3200,3349,3365,255,2189,256,568,671,829,2730,1031,2783,1014,1032,1419,1652,1653,1774,2272,2331,3075,3078,3088,3089,3236,261,3076,1166,2362,262,263,264,265,266,267,563,738,808,809,825,892,1376,1001,1054,1077,1178,1347,1523,1598,1803,2049,2193,2666,2814,2841,2966,2999,3230,3240,3327,3394,3401,2312,1574,279,280,281,282,283,284,556,574,577,579,580,603,605,612,618,620,627,796,875,888,901,909,917,964,2810,997,1057,1121,1276,1572,1759,2002,2020,2044,2195,2222,2334,2335,2488,2597,2664,3068,3295,3096,3281,3405,290,619,716,963,2893,291,292,33,61,62,63,65,68,71,72,74,75,77,78,328,329,330,334,335,529,537,1404,611,668,777,783,929,1006,1058,1072,3268,1185,1285,1293,1294,1323,1433,2000,2100,2105,2128,2179,2213,2314,2316,2329,2434,2578,2593,2685,2773,2790,2835,2867,2897,2929,2965,3019,3057,3144,3147,3172,3173,3174,3214,3232,3233,3305,3339,3341,3342,69,86,1508,760,897,1226,1490,1913,2087,2149,2524,3376,83,84,85,88,647,1308,64,70,73,346,347,348,349,583,866,773,1750,2575,2594,2764,2920,3270,80,2888,76,528,34,35,37,38,39,40,41,43,45,46,47,49,50,51,109,110,111,114,1650,517,1480,602,630,631,649,652,670,675,876,1303,1351,1458,1494,1680,1902,1918,2205,2223,2244,2460,2502,2613,2614,2802,2846,2854,2908,2930,2951,3084,3142,3166,3178,3323,42,57,58,521,522,601,701,1833,2197,2574,2873,3211,3289,36,44,48,52,501,588,641,681,691,772,1156,1367,2096,2325,2510,2592,3351,87,89,508,2267,2665,2832,3392,66,67,79,112,632,646,839,1792,2441,2776,2964,3119,3139,3234,3332,3374,53,54,55,56,59,113,530,534,545,1760,1906,1997,2637,3125,3334
);

$bb25= array(3385,3383,3378,3372,3368,3363,3361,3358,3356,3353,3352,3344,3317,3314,3301,3277,3275,3267,3262,3259,3251,3246,3239,3225,3222,3213,3212,3207,3201,3196,3194,3186,3185,3179,3177,3159,3141,3140,3133,3132,3112,3106,3105,3100,3095,3092,3082,3081,3073,3063,3038,3036,3031,3026,3025,3021,3016,2997,2986,2967,2962,2959,2928,2925,2910,2904,2900,2889,2887,2886,2876,2866,2862,2861,2860,2837,2834,2831,2830,2827,2825,2823,2800,2798,2792,2785,2781,2775,2761,2744,2743,2742,2731,2718,2703,2702,2692,2691,2690,2672,2663,2661,2653,2650,2649,2643,2634,2631,2627,2623,2619,2616,2612,2603,2598,2580,2567,2562,2559,2554,2545,2544,2538,2528,2519,2518,2515,2511,2504,2503,2501,2500,2492,2459,2457,2456,2453,2450,2442,2440,2426,2423,2415,2413,2403,2388,2387,2384,2383,2375,2369,2367,2359,2339,2337,2332,2328,2324,2322,2317,2315,2309,2308,2285,2259,2257,2255,2253,2250,2242,2238,2232,2214,2212,2210,2207,2206,2177,2173,2170,2157,2143,2140,2137,2129,2120,2118,2116,2111,2109,2108,2097,2094,2090,2085,2070,2059,2046,2028,2023,2015,2011,2010,2009,2001,1999,1990,1984,1979,1975,1973,1972,1970,1968,1965,1962,1961,1955,1941,1937,1930,1927,1926,1914,1901,1898,1896,1891,1890,1882,1873,1866,1855,1853,1850,1846,1835,1823,1822,1821,1814,1806,1804,1802,1801,1782,1780,1766,1765,1764,1757,1753,1742,1741,1737,1733,1732,1731,1722,1720,1716,1715,1713,1712,1711,1710,1705,1701,1690,1681,1679,1678,1676,1674,1665,1659,1640,1636,1633,1632,1630,1612,1611,1600,1585,1561,1559,1545,1543,1531,1529,1528,1525,1520,1512,1509,1507,1503,1501,1498,1496,1495,1488,1483,1481,1461,1457,1451,1450,1440,1436,1434,1430,1415,1414,1405,1397,1388,1386,1377,1375,1370,1365,1342,1335,1331,1330,1328,1327,1321,1318,1302,1301,1299,1298,1296,1287,1278,1268,1263,1261,1259,1258,1255,1254,1249,1247,1245,1244,1242,1239,1238,1237,1236,1228,1227,1221,1220,1218,1216,1215,1214,1206,1205,1204,1202,1201,1195,1194,1191,1190,1189,1184,1181,1179,1176,1174,1173,1172,1165,1164,1159,1157,1155,1154,1149,1147,1145,1143,1141,1139,1138,1133,1131,1129,1127,1125,1124,1122,1119,1115,1111,1110,1108,1104,1103,1102,1098,1097,1092,1091,1088,1086,1085,1084,1081,1078,1071,1069,1068,1067,1065,1056,1052,1051,1049,1048,1046,1044,1042,1041,1036,1035,1027,1023,1022,1021,1020,1019,1015,1013,1011,1010,1009,1005,1004,1000,999,998,991,990,989,988,987,986,985,982,981,977,976,971,970,969,966,961,959,956,953,952,947,946,945,937,930,928,927,926,925,924,923,921,919,916,910,906,905,903,900,899,898,896,895,894,893,883,877,873,872,869,862,860,859,858,856,854,851,847,842,841,835,834,832,830,826,823,821,819,818,815,814,803,802,801,800,794,790,789,785,779,778,771,756,746,744,737,733,722,711,708,699,692,686,684,683,682,680,679,678,673,669,667,660,657,654,644,642,640,639,638,637,636,629,628,625,622,617,616,613,606,604,599,597,596,595,591,585,584,582,576,573,572,571,569,566,558,552,541,540,533,526,513,506,500,305,304,303,302,301,300,299,298,297,296,295,294,293,289,288,287,286,285,278,277,276,275,274,273,272,271,270,269,268,260,259,257,254,229,228,227,226,225,224,214,213,212,211,206,205,204,203,202,201,200,199,198,197,196,184,183,181,180,179,178,177);

$bb34 = array( 3403, 3382, 3379, 3377, 3371, 3366, 3362, 3360, 3359, 3357, 3340, 3333, 3331, 3330, 3329, 3326, 3321, 3316, 3315, 3311, 3303, 3302, 3300, 3297, 3296, 3294, 3291, 3279, 3269, 3264, 3261, 3231, 3223, 3204, 3203, 3195, 3192, 3169, 3167, 3160, 3154, 3151, 3150, 3136, 3131, 3123, 3111, 3110, 3107, 3102, 3070, 3056, 3043, 3033, 3023, 3011, 3008, 3007, 3004, 3002, 2998, 2994, 2989, 2987, 2984, 2971, 2968, 2958, 2954, 2953, 2935, 2931, 2927, 2926, 2921, 2913, 2912, 2909, 2901, 2883, 2882, 2880, 2868, 2863, 2845, 2843, 2836, 2829, 2828, 2817, 2816, 2815, 2812, 2811, 2801, 2789, 2780, 2769, 2767, 2763, 2762, 2758, 2757, 2751, 2746, 2741, 2732, 2728, 2723, 2710, 2708, 2700, 2698, 2680, 2670, 2668, 2660, 2658, 2657, 2642, 2636, 2633, 2625, 2624, 2621, 2620, 2610, 2608, 2605, 2596, 2589, 2583, 2581, 2579, 2573, 2572, 2571, 2570, 2557, 2542, 2537, 2534, 2533, 2532, 2507, 2505, 2491, 2489, 2482, 2475, 2472, 2468, 2455, 2446, 2444, 2443, 2439, 2438, 2436, 2425, 2420, 2417, 2404, 2402, 2400, 2382, 2374, 2372, 2371, 2370, 2368, 2364, 2363, 2358, 2357, 2356, 2355, 2354, 2349, 2348, 2344, 2342, 2318, 2310, 2307, 2297, 2295, 2292, 2288, 2287, 2286, 2281, 2278, 2277, 2276, 2275, 2271, 2270, 2269, 2268, 2265, 2262, 2258, 2252, 2248, 2245, 2243, 2241, 2236, 2229, 2224, 2215, 2211, 2202, 2200, 2199, 2194, 2178, 2176, 2175, 2174, 2165, 2163, 2161, 2152, 2148, 2138, 2135, 2134, 2126, 2125, 2124, 2121, 2119, 2113, 2112, 2107, 2103, 2099, 2089, 2088, 2082, 2080, 2074, 2072, 2067, 2062, 2058, 2056, 2048, 2041, 2032, 2017, 2014, 2013, 2008, 2004, 2003, 1994, 1992, 1991, 1987, 1985, 1982, 1981, 1980, 1978, 1977, 1976, 1964, 1963, 1957, 1956, 1953, 1949, 1943, 1936, 1934, 1922, 1916, 1915, 1904, 1894, 1892, 1888, 1885, 1884, 1883, 1880, 1877, 1876, 1875, 1872, 1869, 1867, 1864, 1862, 1859, 1857, 1856, 1852, 1847, 1845, 1844, 1842, 1834, 1832, 1827, 1825, 1819, 1818, 1816, 1815, 1808, 1807, 1805, 1800, 1795, 1794, 1790, 1788, 1784, 1771, 1768, 1763, 1761, 1747, 1744, 1740, 1739, 1730, 1728, 1724, 1717, 1700, 1694, 1692, 1691, 1677, 1671, 1670, 1664, 1663, 1662, 1661, 1658, 1656, 1649, 1647, 1646, 1645, 1644, 1635, 1631, 1624, 1623, 1622, 1618, 1610, 1606, 1605, 1597, 1593, 1591, 1588, 1579, 1571, 1569, 1568, 1564, 1563, 1562, 1552, 1551, 1550, 1549, 1548, 1547, 1546, 1521, 1511, 1506, 1484, 1479, 1478, 1472, 1471, 1467, 1465, 1464, 1463, 1453, 1431, 1429, 1426, 1423, 1421, 1420, 1416, 1412, 1409, 1401, 1392, 1383, 1380, 1373, 1368, 1359, 1355, 1354, 1346, 1343, 1340, 1339, 1337, 1324, 1314, 1310, 1309, 1307, 1300, 1290, 1288, 1269, 1264, 1235, 1233, 1222, 1186, 1153, 1148, 1142, 1140, 1128, 1118, 1116, 1096, 1095, 1094, 1083, 1059, 1053, 1047, 1040, 1008, 979, 973, 938, 931, 889, 827, 816, 788, 786, 770, 768, 712, 703, 690, 687, 685, 672, 664, 658, 653, 651, 650, 643, 614, 592, 589, 587, 575, 562, 559, 557, 546, 543, 470, 469, 468, 467, 466, 465, 464, 463, 462, 461, 460, 459, 458, 457, 456, 455, 454, 453, 452, 451, 450, 449, 448, 447, 446, 445, 444);

$bb38= array(3406,3398,3396,3395,3389,3388,3387,3386,3384,3373,3367,3364,3354,3348,3347,3346,3343,3336,3335,3328,3322,3320,3313,3312,3310,3308,3306,3299,3293,3288,3287,3286,3284,3280,3273,3272,3260,3258,3257,3256,3255,3254,3253,3252,3245,3244,3243,3242,3238,3228,3224,3221,3220,3217,3216,3215,3210,3209,3208,3206,3199,3198,3197,3193,3191,3188,3184,3183,3182,3181,3175,3171,3170,3163,3162,3158,3155,3153,3149,3148,3146,3145,3143,3138,3137,3135,3130,3127,3126,3121,3118,3117,3113,3109,3108,3104,3101,3099,3090,3079,3072,3067,3066,3065,3064,3062,3061,3058,3055,3054,3053,3052,3051,3049,3047,3042,3041,3040,3039,3035,3029,3028,3027,3020,3018,3017,3015,3012,3010,3006,3001,2992,2991,2990,2988,2981,2980,2979,2977,2976,2975,2974,2973,2972,2970,2963,2960,2956,2948,2942,2941,2940,2938,2937,2933,2922,2919,2918,2917,2916,2914,2911,2907,2906,2905,2903,2899,2896,2895,2894,2891,2890,2885,2884,2881,2879,2874,2872,2871,2870,2859,2858,2857,2856,2853,2851,2847,2844,2838,2826,2822,2821,2813,2805,2804,2803,2799,2796,2795,2791,2779,2774,2772,2765,2760,2759,2756,2755,2753,2749,2748,2747,2739,2737,2736,2735,2729,2727,2726,2724,2722,2719,2707,2705,2704,2701,2696,2695,2694,2693,2688,2687,2684,2683,2679,2678,2676,2674,2671,2669,2667,2662,2655,2654,2652,2651,2648,2646,2645,2644,2641,2638,2630,2609,2606,2601,2599,2595,2590,2586,2585,2584,2582,2569,2568,2566,2564,2561,2560,2558,2553,2551,2550,2549,2548,2536,2531,2529,2526,2522,2521,2517,2516,2514,2513,2512,2497,2495,2494,2486,2485,2484,2483,2481,2476,2469,2467,2466,2465,2451,2449,2447,2430,2429,2428,2427,2424,2422,2414,2411,2409,2408,2405,2399,2397,2396,2395,2394,2389,2386,2381,2380,2379,2378,2373,2365,2361,2353,2350,2347,2345,2343,2341,2340,2336,2330,2327,2326,2323,2321,2319,2311,2305,2303,2301,2300,2299,2298,2296,2294,2293,2290,2289,2284,2283,2282,2263,2260,2256,2254,2249,2247,2246,2237,2219,2218,2217,2216,2209,2204,2203,2191,2186,2185,2184,2183,2182,2181,2172,2171,2162,2159,2153,2147,2142,2141,2139,2133,2131,2123,2110,2106,2104,2098,2095,2091,2086,2084,2083,2081,2079,2077,2076,2073,2071,2066,2065,2064,2061,2055,2047,2043,2042,2040,2035,2034,2027,2026,2025,2024,2022,2021,2018,2016,2012,2006,1988,1983,1974,1971,1967,1966,1960,1959,1954,1951,1950,1948,1945,1944,1942,1939,1938,1935,1932,1931,1929,1921,1920,1917,1908,1907,1903,1900,1899,1889,1879,1863,1858,1854,1851,1849,1838,1831,1829,1828,1826,1824,1812,1811,1810,1799,1798,1797,1783,1779,1776,1773,1772,1769,1767,1756,1752,1751,1749,1748,1745,1743,1738,1729,1727,1721,1718,1714,1706,1704,1697,1696,1689,1688,1687,1686,1684,1683,1682,1669,1668,1666,1657,1655,1654,1641,1638,1634,1626,1625,1621,1620,1614,1604,1603,1601,1596,1595,1594,1587,1586,1584,1580,1570,1567,1566,1560,1558,1537,1536,1532,1530,1527,1526,1518,1516,1513,1510,1505,1504,1493,1491,1489,1486,1476,1475,1474,1473,1470,1468,1462,1455,1452,1449,1448,1447,1444,1442,1441,1439,1432,1427,1424,1422,1418,1417,1410,1408,1395,1394,1393,1391,1389,1387,1385,1384,1381,1371,1369,1364,1360,1358,1357,1353,1349,1348,1345,1344,1332,1326,1325,1322,1319,1316,1306,1305,1304,1295,1292,1284,1283,1282,1280,1279,1277,1271,1265,1262,1257,1241,1240,1234,1231,1230,1219,1213,1212,1211,1210,1209,1207,1200,1198,1197,1196,1188,1187,1182,1180,1177,1160,1158,1150,1146,1144,1135,1134,1130,1123,1114,1113,1112,1106,1101,1100,1099,1090,1089,1087,1082,1076,1075,1074,1070,1066,1061,1050,1034,1033,1018,996,995,993,984,983,978,975,967,965,949,942,941,939,922,915,904,902,891,884,882,881,870,867,865,864,863,861,855,852,850,849,845,828,824,822,817,811,807,805,798,795,787,784,767,765,764,761,758,757,755,754,753,752,750,749,745,743,742,741,739,736,735,732,731,728,717,695,694,693,689,688,674,665,659,645,626,624,623,615,600,586,581,567,555,553,547,536,532,531,525,524,523,514,511,507,443,442,441,440,439,438,437,436,435,434,433,432,431,430,429,428,427,426,425,424,423,422,421,420,419,418,417,416,415,414,413,412,411,410,409,408,407,406,405,404,403,402,401,400,399,);


$BB = array('080019884','080034474','080064242','080084288','080104788','080112202','080120801','080141349','080149024','080329810','081072310','081087112','081185170','081297011','080076818','081029085','081245320','081435520','081436821','081437222','081552386','007066642','080893654','081187287','081426886','007018277','008017261','008017281','040130486','070640670','080062163','080065757','080144364','081023747','081467326','081524866','081526364','090150142','080113322','080120283','080136680','080345157','081152341','081152441','081153241','081153649','081335153','081386652','070230918','080036300','080057862','080092139','080092146','080092160','080101572','080113810','080113827','080113834','080120962','080120979','080121020','080137762','090001218','008008262','008008297','008017276','080038182','080038199','080090531','080094287','080141950','080144234','080144241','080144302','080144333','008008306','081098440','008008277','008008282','009000017','050111858','070185951','070323977','070350710','070464472','080027872','080062187','080076849','080111670','080124168','080124175','080137410','080593589','080676977','080680178','080842092','080893257','080905946','080928256','081060387','081076417','081076916','081153547','081227682','081228289','081228584','081455750','090000094','090000100','090014786','090109086','080071974','080439616','080725557','081074459','081385058','090056251','080094263','080144296','080144319','081103681','081416678','080815980','080986540','081441453','080049126','081146175','080137144','080137205','080893858','081294151','081529270','005036523','006033323','007059194','008003509','008003618','008013516','040130089','040130282','040130681','060028178','070156912','070609558','070642911','070657852','070755263','070765879','080003623','080004354','080010201','080012431','080012984','080013981','080014452','080020538','080027544','080029944','080037895','080041557','080041618','080044152','080045920','080053901','080055619','080057404','080058029','080059590','080063122','080063849','080068806','080077983','080080143','080083106','080086138','080086534','080086565','080086718','080088507','080088521','080088552','080088569','080088644','080090760','080096991','080097035','080097929','080106317','080108106','080108991','080111472','080114138','080116804','080120313','080120986','080122317','080124090','080125806','080129873','080129880','080129903','080130435','080131487','080131500','080131944','080133115','080133214','080133849','080133917','080134310','080137373','080137434','080139100','080139810','080141509','080141585','080142032','080142094','080144265','080144272','080144326','080144371','080148614','080149666','080151096','080160813','080182176','080189171','080239676','080251383','080269771','080297812','080300518','080324619','080328895','080345259','080372594','080372696','080372952','080398397','080406550','080439412','080439514','080473997','080474413','080487194','080559254','080561379','080561572','080589716','080656543','080675639','080720112','080761911','080772577','080774894','080776698','080785575','080795315','080807583','080813867','080814261','080814667','080814769','080815787','080817081','080862174','080894159','080945070','080983750','081048553','081073151','081075030','081076712','081083656','081096577','081100251','081101613','081101817','081108057','081117370','081123858','081126156','081139295','081139794','081139896','081141528','081180875','081187083','081187185','081218095','081228788','081234478','081249715','081291073','081319473','081319575','081319677','081328023','081372246','081431846','081434995','081436127','081442457','081453247','081467927','081474354','081519617','081531215','081544347','081553186','090001513','090003651','090007338','090047047','090048711','090087513','090087717','090088018');

$z38 = array('400','401','402','403','404','406','407','408','411','412','413','414','420','421','422','423','424','426','427','428','429','432','433','434','435','436','437','438','439','500','502','503','504','505','506','507','508','509','510','511','512','513','514','515','516','520','521','522','523','524','525','526','527','528','530','540','541','542','544','545','546','551','552','553','555','556','557','558');

$z25 = array('104','105','111','112','114','115','200','201','202','203','204','205','206','221','224','238','242','243','247','251','252','260','261','262','263','264','265','266','267','268','269','270','272','970','971','972','973','974','975','976','977','978','979','981','982','983');

$z34 = array('600','602','603','604','605','606','607','608','611','612','613','614','615','616','621','622','623','624','625','630','631','632','633','634','635','636','637','638','640','643','646','647','648','649','651','652','653','654','655','700','701','702','704','708','709','710','711','712','713','714','715','716','717','718','719','720','721','722','723','724','725','726','727','730','731','732','733','734','735','736','737','741','742','743','744','745','600a','600b');

$z42 = array('800','801','802','803','804','805','806','807','811','812','813','814','815','820','821','822','823','824','825','826','827','828','829','830','831','832','833','840','842','843','844','845','846','847','848','849','851','852','880','881','882','883','884','885','900','901','902','903','904','905','906','907','908','909','911','912','913','920','921','922','923','924','925','926','927','928','929','931','932','940','941','942','943','944','945','946','947','950','951','952','953','954','955','956','957','958','959','961','962','963','964','965','966');
$z47 = array('100','103','106','108','110','116','207','208','220','222','223','226','227','228','231','232','233','234','235','236','237','239','241','244','248','249','253','320','324','325','326','327','328','330','333','334','335','336','337','338');
?>